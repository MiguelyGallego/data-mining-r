airbnb<-read.csv('airbnb-listings.csv',sep = ';')
airbnb<-read.csv('airbnb-listings.csv',sep = ';')
airbnb<-read.csv('airbnb-listings.csv',sep = ';')
options(repr.plot.height=4,repr.plot.width=6,repr.plot.res = 300)
df_madrid -> df(airbnb$City, airbnb$Room.Type, airbnb$Neighbourhood, airbnb$Accommodates, airbnb$Bathrooms, airbnb$Bedrooms, airbnb$Beds)
df_madrid <- df(airbnb$City, airbnb$Room.Type, airbnb$Neighbourhood, airbnb$Accommodates, airbnb$Bathrooms, airbnb$Bedrooms, airbnb$Beds)
df_madrid <- subset(airbnb, City == "Madrid" & Room.Type == "Entire home/apt" & Neighbourhood != "")[, c("Neighbourhood", "Accommodates", "Bathrooms", "Bedrooms", "Beds", "Price", "Square.Feet", "Guests.Included", "Extra.People", "Review.Scores.Rating", "Latitude", "Longitude")]
airbnb.heda
airbnb[6,]
airbnb[6,]
airbnb[1:6,]
df_madrid[1:5,]
airbnb<-read.csv('airbnb-listings.csv',sep = ';')
options(repr.plot.height=4,repr.plot.width=6,repr.plot.res = 300)
df_madrid <- subset(airbnb, City == "Madrid" & Room.Type == "Entire home/apt" & Neighbourhood != "")[, c("Neighbourhood", "Accommodates", "Bathrooms", "Bedrooms", "Beds", "Price", "Square.Feet", "Guests.Included", "Extra.People", "Review.Scores.Rating", "Latitude", "Longitude")]
str(df_madrid)
df_madrid$Square.Meters <- round(df_madrid$Square.Feet * 0.092903, 3)
str(df_madrid)
per_nasquare <- sum(is.na(df_madrid$Square.Meters)) / length(df_madrid$Square.Meters)*100
per_nasquare
per_zerosquare <-length(which(df_madrid$Square.Meters==0)) / sum(!is.na(df_madrid$Square.Meters)) *100
per_zerosquare
df_madrid$Square.Meters  <- ifelse(df_madrid$Square.Meters==0, NA, df_madrid$Square.Meters)
length(which(df_madrid$Square.Meters==0))
library(ggplot2)
# hist(df_madrid$Square.Meters)
ggplot(df_madrid,aes(x=Square.Meters)) + geom_histogram()
df_madrid$Square.Meters  <- ifelse(df_madrid$Square.Meters < 20, NA, df_madrid$Square.Meters)
unique(df_madrid$Neighbourhood)
df_sin <- df_madrid[!is.na(df_madrid$Square.Meters),]
unique(df_sin)
unique(df_madrid$Neighbourhood)
df_sin <- df_madrid[!is.na(df_madrid$Square.Meters),]
unique(df_sin)
unique(df_madrid$Neighbourhood)
df_sin <- df_madrid[!is.na(df_madrid$Square.Meters),]
unique(df_sin)
unique(df_madrid$Neighbourhood)
unique(df_sin)
unique(df_sin$Neighbourhood)
df_sin <- df_madrid[!is.na(df_madrid$Square.Meters), df_madrid$Square.Meters]
df_sin <- df_madrid[!is.na(df_madrid$Square.Meters), Square.Meters]
df_sin <- df_madrid[!is.na(df_madrid$Square.Meters),]
unique(df_sin$Neighbourhood)
unique(df_madrid$Neighbourhood)
df_sin <- df_madrid[!is.na(df_madrid$Square.Meters),]
unique(df_sin$Neighbourhood)
all(is.na(df_madrid$Square.Meters))
all(is.na(df_madrid$Square.Meters))
all(is.na(df_madrid$Neighbourhood))
df_madrid$Neighbourhood
table(df_madrid$Neighbourhood)
table(df_madrid$Neighbourhood)[is.na(df_madrid$Square.Meters),]
name(table(df_madrid$Neighbourhood))
names(table(df_madrid$Neighbourhood))
unique(df_madrid$Neighbourhood)
names(table(df_madrid$Neighbourhood))
df_madrid[is.na(df_madrid$Square.Meters)]
df_madrid[is.na(df_madrid$Square.Meters),]
df_madrid[is.na(df_madrid$Square.Meters), Neighbourhood]
df_madrid[is.na(df_madrid$Square.Meters), df_madrid$Neighbourhood]
df_madrid[is.na(df_madrid$Square.Meters), 1]
df_madrid[is.na(df_madrid$Square.Meters), ]
df_madrid[is.na(df_madrid$Square.Meters), "Neighbourhood"]
df_madrid[is.na(df_madrid$Square.Meters), unique(df_madrid$Neighbourhood)]
df_madrid[is.na(df_madrid$Square.Meters), table(df_madrid$Neighbourhood)]
df_madrid[is.na(df_madrid$Square.Meters)]
df_madrid[is.na(df_madrid$Square.Meters),]
df_madrid[is.na(table(df_madrid$Square.Meters))]
names(table(df_madrid$Neighbourhood))
df_madrid[is.na(table(df_madrid$Square.Meters))]
df_madrid[is.na(table(df_madrid$Square.Meters))]
df_madrid[is.na(table(df_madrid$Square.Meters))]
names(table(df_madrid$Neighbourhood))
df_madrid[is.na(table(df_madrid$Square.Meters))]
table(df_madrid$Square.Meters)
df_madrid[is.na(table(df_madrid$Square.Meters))]
is.na(table(df_madrid$Square.Meters))
table(df_madrid$Square.Meters)
is.na(table(df_madrid$Square.Meters))
df_madrid$Square.Meters
names(table(df_madrid$Neighbourhood))
table(df_madrid$Neighbourhood)
table(df_madrid$Neighbourhood)[df_madrid$Square.Meters,]
table(df_madrid$Neighbourhood)[df_madrid$Square.Meters]
df_madrid$Neighbourhood[df_madrid$Square.Meters]
)
table(df_madrid$Neighbourhood)[df_madrid$Square.Meters]
df_madrid[is.na(table(df_madrid$Square.Meters))]
names(table(df_madrid$Barrio)[is.na(table(df_madrid$Square.Meters))])
names(table(df_madrid$Barrio)[is.na(table(df_madrid$Square.Meters))])
unique(df_madrid$Neighbourhood)
df_sin <- df_madrid[!is.na(df_madrid$Square.Meters),]
unique(df_sin$Neighbourhood)
all(is.na(df_madrid$Neighbourhood))
table(df_madrid$Neighbourhood)[df_madrid$Square.Meters]
df_madrid[is.na(table(df_madrid$Square.Meters))]
names(table(df_madrid$Barrio)[is.na(table(df_madrid$Square.Meters))])
names(table(df_madrid$Barrio)[is.na(table(df_madrid$Square.Meters))])
unique(df_madrid$Neighbourhood)
df_sin <- df_madrid[!is.na(df_madrid$Square.Meters),]
unique(df_sin$Neighbourhood)
all(is.na(df_madrid$Neighbourhood))
names(table(df_madrid$Barrio)[is.na(table(df_madrid$Square.Meters))])
barrios_sin_metros
unique(df_madrid$Neighbourhood)
df_sin <- df_madrid[!is.na(df_madrid$Square.Meters),]
unique(df_sin$Neighbourhood)
all(is.na(df_madrid$Neighbourhood))
barrios_sin_metros <- names(which(sapply(split(df_madrid$Square.Meters, df_madrid$Neighbourhood), function(x) all(is.na(x)))))
barrios_sin_metros
barrios_sin_metros
split(df_madrid$Square.Meters, df_madrid$Neighbourhood)
split(df_madrid$Neighbourhood, df_madrid$Square.Meters )
barrios_sin_metros <- names(which(sapply(split(df_madrid$Square.Meters, df_madrid$Neighbourhood), function(x) all(is.na(x)))))
barrios_sin_metros
barrios_sin_metros <- names(which(sapply(split(df_madrid$Square.Meters, df_madrid$Neighbourhood), function(x) all(is.na(x)))))
barrios_sin_metros
df_madrid <- df_madrid[!df_madrid$Neighbourhood %in% barrios_sin_metros,]
df_madrid$Neighbourhood
table(df_madrid$Neighbourhood)
table(df_madrid$Neighbourhood)
names(df_madrid$Neighbourhood)
names(df_madrid$Neighbourhood)
names(table(df_madrid$Neighbourhood))
tky<-TukeyHSD(aov( formula=Square.Meters~Neighbourhood, data=df_madrid ))
tky.result<-data.frame(tky$Neighbourhood)
cn <-sort(unique(df_madrid$Neighbourhood))
resm <- matrix(NA, length(cn),length(cn))
rownames(resm) <- cn
colnames(resm) <- cn
resm[lower.tri(resm) ] <- round(tky.result$p.adj,4)
resm[upper.tri(resm) ] <- t(resm)[upper.tri(resm)]
diag(resm) <- 1
library(ggplot2)
library(reshape2)
dfResm <- melt(resm)
ggplot(dfResm, aes(x=Var1, y=Var2, fill=value))+
geom_tile(colour = "black")+
scale_fill_gradient(low = "white",high = "steelblue")+
ylab("Class")+xlab("Class")+theme_bw()+
theme(axis.text.x = element_text(angle = 90, hjust = 1),legend.position="none")
